# Leverage 14.04 LTS, same as Vagrant
sudo: required
dist: trusty

# Set our language to generic for a minimal setup
# https://docs.travis-ci.com/user/trusty-ci-environment#Image-differences-from-Precise
language: generic

# DEV: Due to the nature of Travis CI, we must use the `exec` backend for testing
#   Additionally, since we need to execute some commands as root
#   and since Serverspec doesn't support `sudo` invocations with the `exec`
#   we need to install/invoke our test commands with `sudo`
before_install:
  # Install bundler for the root user
  - sudo gem install bundler

  # Output OS information
  - sudo ruby --version
  - sudo bundle --version

install:
  # Install repo specific dependencies
  - sudo bundle install

script:
  # Run our provisioner
  - bin/bootstrap-travis-ci.sh

  # Run Travis tests
  - bin/test-travis-ci.sh

# Only receive notifications on the start of a new branch and when it changes status
notifications:
  email:
    recipients:
      - todd@twolfson.com
    on_success: change
    on_failure: change
